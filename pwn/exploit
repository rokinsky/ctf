#!/usr/local/bin/python3
from pwn import *
from random import randrange, seed
import array
import numpy as np

seed(42)

def make_data(datasize):
	''' Make some random bytes '''
	return bytes(randrange(256) for _ in range(datasize))

def memfrob(s):
	#return ''.join([chr(ord(c) ^ 42) for c in str(s)])
	#
	return (np.frombuffer(s, dtype=np.uint8) ^ 42).tobytes()
	# 
	# arr = array.array("L", s)
	# for i in range(len(arr)):
	# 	arr[i] ^= 42
	# return arr.tobytes()

def connect():
	return process("./bsk")

def send(r, msg):
	r.sendline(str(len(msg)))
	r.send(msg)

def main():
	r = connect()
	msg = make_data(256)#b'a' * 0x04
	print('memfrob', memfrob(msg))
	send(r, msg)

if __name__ == '__main__':
    main()
